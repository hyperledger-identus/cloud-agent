package io.iohk.atala.pollux.anoncreds

import scala.jdk.CollectionConverters.*
import scala.language.implicitConversions

/** @see
  *   https://hyperledger.github.io/anoncreds-spec/
  */
object AnoncredLib {

  val SCHEMA_ID = "mock:uri2"
  val CRED_DEF_ID = "mock:uri2"
  val ISSUER_DID = "mock:issuer_id/path&q=bar"

  // issuer or any
  def createSchema(
      name: String, // SCHEMA_ID
      version: String, // SCHEMA_Version
      attr_names: AttributeNames,
      issuer_id: IssuerId, // ISSUER_DID
  ): SchemaDef = anoncreds_wrapper.Schema.apply(name, version, attr_names.toSeq.asJava, issuer_id)

  // issuer
  def createCredDefinition(
      issuer_id: String,
      schema: SchemaDef,
      tag: String,
      supportRevocation: Boolean,
      signature_type: anoncreds_wrapper.SignatureType.CL.type = anoncreds_wrapper.SignatureType.CL
  ) = {
    val credentialDefinition: anoncreds_wrapper.IssuerCreateCredentialDefinitionReturn =
      anoncreds_wrapper
        .Issuer()
        .createCredentialDefinition(
          schema.name,
          schema: anoncreds_wrapper.Schema,
          issuer_id,
          tag,
          signature_type,
          anoncreds_wrapper.CredentialDefinitionConfig(supportRevocation)
        )

    CreateCredentialDefinition(
      credentialDefinition.getCredentialDefinition(),
      credentialDefinition.getCredentialDefinitionPrivate(),
      credentialDefinition.getCredentialKeyCorrectnessProof()
    )
  }

  // issuer
  def createOffer(
      credentialDefinition: CreateCredentialDefinition,
      credentialDefinitionId: String
  ): CredentialOffer =
    anoncreds_wrapper
      .Issuer()
      .createCredentialOffer(
        credentialDefinition.cd.schemaId, // string schema_id,
        credentialDefinitionId, // string cred_def_id,
        credentialDefinition.proofKey // CredentialKeyCorrectnessProof correctness_proof
      )

  // holder
  def createCredentialRequest(
      linkSecret: LinkSecretWithId,
      credentialDefinition: CredentialDefinition,
      credentialOffer: CredentialOffer,
      entropy: String = {
        val tmp = scala.util.Random()
        tmp.setSeed(java.security.SecureRandom.getInstanceStrong().nextLong())
        tmp.nextString(80)
      }
  ): CreateCrendentialRequest = {
    val credentialRequest =
      anoncreds_wrapper
        .Prover()
        .createCredentialRequest(
          entropy, // string? entropy,
          null, // string? prover_did,
          credentialDefinition, // CredentialDefinition cred_def,
          linkSecret.secret, // LinkSecret link_secret,
          linkSecret.id, // string link_secret_id,
          credentialOffer, // CredentialOffer credential_offer
        )

    CreateCrendentialRequest(credentialRequest.getRequest(), credentialRequest.getMetadata())
  }

  // holder
  def processCredential(
      credential: Credential,
      metadata: CredentialRequestMetadata,
      linkSecret: LinkSecretWithId,
      credentialDefinition: CredentialDefinition,
  ): Unit = {
    anoncreds_wrapper
      .Prover()
      .processCredential(
        credential, // Credential,
        metadata, //  CredentialRequestMetadata,
        linkSecret.secret, // LinkSecret,
        credentialDefinition, //  CredentialDefinition,
        null // evRegDef: RevocationRegistryDefinition?
      )
  }

  // issuer
  def createCredential(
      credentialDefinition: CredentialDefinition,
      credentialDefinitionPrivate: CredentialDefinitionPrivate,
      credentialOffer: CredentialOffer,
      credentialRequest: CredentialRequest,
      attributeValues: Seq[(String, String)]
      //  java.util.List[AttributeValues] : java.util.List[AttributeValues]
      //  revocationRegistryId : String
      //  revocationStatusList : RevocationStatusList
      //  credentialRevocationConfig : CredentialRevocationConfig
  ): Credential = {
    anoncreds_wrapper
      .Issuer()
      .createCredential(
        credentialDefinition, // CredentialDefinition cred_def,
        credentialDefinitionPrivate, // CredentialDefinitionPrivate cred_def_private,
        credentialOffer, // CredentialOffer cred_offer,
        credentialRequest, // CredentialRequest cred_request,
        attributeValues
          .map(e => anoncreds_wrapper.AttributeValues(e._1, e._2))
          .asJava, // sequence<AttributeValues> cred_values,
        null, // RevocationRegistryId? rev_reg_id,
        null, // RevocationStatusList? rev_status_list,
        null, // CredentialRevocationConfig? revocation_config
      )
  }

  type SchemaId = String
  type CredentialDefinitionId = String

  // TODO FIX
  // [info] uniffi.anoncreds.AnoncredsException$CreatePresentationException: Create Presentation: Error: Error: Invalid structure
  // [info] Caused by: Predicate is not satisfied

  def createPresentation(
      presentationRequest: PresentationRequest,
      credentialRequests: Seq[CredentialAndRequestedAttributesPredicates],
      selfAttested: Map[String, String],
      linkSecret: LinkSecret,
      schemas: Map[SchemaId, SchemaDef],
      credentialDefinitions: Map[CredentialDefinitionId, CredentialDefinition],
  ): Presentation = {
    anoncreds_wrapper
      .Prover()
      .createPresentation(
        presentationRequest, // uniffi.anoncreds
        credentialRequests
          .map(i => i: anoncreds_wrapper.CredentialRequests)
          .asJava, // sequence<Credential> credentials,
        selfAttested.asJava, // record<string, string>? self_attested,
        linkSecret, // LinkSecret link_secret,
        schemas.view
          .mapValues(i => i: anoncreds_wrapper.Schema)
          .toMap
          .asJava, // record<SchemaId, Schema> schemas,
        credentialDefinitions.view.mapValues(i => i: anoncreds_wrapper.CredentialDefinition).toMap.asJava
        // record<CredentialDefinitionId, CredentialDefinition> credential_definitions
      )
  }

  // TODO FIX
  // uniffi.anoncreds.AnoncredsException$ProcessCredentialException: Verify Presentation: Error:
  // Requested restriction validation failed for "{"sex": Some("M")}" attributes [$and operator validation failed.
  // [$eq operator validation failed for tag: "attr::sex::value", value: "F" [Proof rejected: "attr::sex::value" values are different: expected: "F", actual: "M"]]]

  // TODO FIX
  // uniffi.anoncreds.AnoncredsException$ProcessCredentialException: Verify Presentation: Error: Requested restriction validation failed for "{"sex": Some("M")}" attributes [$and operator validation failed. [$eq operator validation failed for tag: "cred_def_id", value: "CRED_DEF_ID" [Proof rejected: "cred_def_id" values are different: expected: "CRED_DEF_ID", actual: "mock:uri3"]]]

  // FIXME its always return false ....
  def verifyPresentation(
      presentation: Presentation,
      presentationRequest: PresentationRequest,
      schemas: Map[SchemaId, SchemaDef],
      credentialDefinitions: Map[CredentialDefinitionId, CredentialDefinition],
  ): Boolean = {
    println("11111111111111")
    val aaa = schemas.view
      .mapValues(i => i: anoncreds_wrapper.Schema)
      .toMap
      .asJava // record<SchemaId, Schema> schemas,
    println("22222222222222")
    val bbb = credentialDefinitions.view.mapValues(i => i: anoncreds_wrapper.CredentialDefinition).toMap.asJava
    println("333333333333333")
    val x0: anoncreds_wrapper.Presentation = presentation
    val x00: anoncreds_wrapper.Presentation = anoncreds_wrapper.Presentation(
      """{"proof": {"proofs": [{"primary_proof": {  "eq_proof": {    "revealed_attrs": {      "sex": "4046863355387123130204462347062573430393022542838002397178812848050724434929"    },    "a_prime": "23668947294526966232574255117754943491816707486091544217467031861819742874061586057690685960574114777606559155814516186434982377268177589950616942665745381071174406643978463034961358555347908593316242999079841836598239142752396881130338304110770820043785984176592108320236064173754538191667274172482791212197777090509309171059727669636666194941924722599877754220797580195516001912804720556716507877747860497956446947996794733862374916182479525773799023240609675104487691028876636237890999528461340181344767554231283437160188344615133898841014808642237375350066212161740141047159284944096544548599462623907402405592296",    "e": "128206331536035105232349378446925730403903859372563967141429768772518858237026625732557687711424760526002466517377038850176784701994643807",    "v": "971805150699935693811501377778538464902472371677771741190603933005474413128565563383566445922651959383556831247668182529619591365560257883220642885381933763667377350125698222125763016662662673138358946434140179322419840815505106590808148971127683155036877792081320713275444982677845355356784438962304769242511952959897636954589746683989217902753714379663436750596705454607167565811507631083229373101865894512532579915236485143799188212531925181757669712615689245406972678968719362423615557933014934237913220465306145591071503521141507687468133082485835053891860697115801298885477309404906300065899547142806032976162340756196517133171019698847839316763960715070438614960606561246630473523127588596652522288547461078453019206401091549562809236323579053547386711768863882885456918181246419270262961865979164973409249319192740422735280914793418313816336925471896685126862130129523194950581885403440469357230182148987199295293",    "m": {      "master_secret": "6669908137590671633011970924254842909999971064937520954586916789109617317973708373602103844754811914658299826104198285440517640196602577358220188340226897300594034046172294769730",      "name": "5531320118917441065902205587790390495107074210392663256062055004826776509566034857389946019675387757862610426532577019059650334581452924822669125348900690304363537093409209257827",      "age": "15823189903482204058645623329002082539514070199594089922519743310988189976758910839298370429239645164693109247895271709264338817301199523307016442196193833763435567950525106987991"    },    "m2": "2564914952992239796388348101999462793433803858784471330843877979162109886348887268060551914874335706991118350534814070987570307378424200615630994079329535571254018867754205773143"  },  "ge_proofs": [    {      "u": {        "2": "14717635853033256360546854003819535326646067772991249310148799460682193228496317285301216844527219576188698670524060671119426073166713968820694734509051868759225163491913689721296",        "1": "2616821438436096787739128890585360281910056057807698373609907993387199591930472886440863831127491227186002513568874503844957885900947227032971752587099183409506399460663219283684",        "0": "13572810704684480329191469978412223114528760132550695105523841848993748910181177352331908824115226260671374016013557532074547327372392818503039044053291245070470191705751199929141",        "3": "9302637570201727944701682003199873734020845011529035752266875836046439045023106136655261392129556341965549907045766602966448250133147647021752101104689106829751032259218390878072"      },      "r": {        "DELTA": "759482653982920227551847709101428917110495094901584845456770249929896243919042392785018140544274638212728809209236309109649860034586512031642190013172374287043501104948035803474369844069129001834140202128365449538250569380239790363716841926483540802203389912373645379648750417791785208264994474479999449754888653510622200056176533035472932697941846496547325034482921037003619382713301851820195523278012108405431826477916777940794502832446983292667501529591703222944099107280769496891274565299317087086883384600186639468370485073277204781799714111349767506912187429176351208502968408206456572057135392373944424467851274287383471591211885953450907973524025177510421136907544045965003065803150130173463748373775295471304",        "3": "1294623570125721994811860653085367316591034914309655556143352772097128855709046214396475057034803015603123247794728844893184954882891295793238656041662431489444343469387680471720423119762508896203368244681174681621013247801160879802671124951807661956242570548010683056882766498508367737610174822209828286459272626096444886017729862922658827920623595302156231487228097643470090474477138401823545657806820417305282849941867663507838338320073088144868414595952869817437350968294185802085867355372548686925174985790368486812626340453108843444811584604842896785569110968272836962281464798856812310237234438978643019105027238845826928102618298122462279238239908289234045805021330429376300618781407034861380016852201409758531",        "1": "645802634658108939111394047514409601422150132629797664130671824326891918091039778772336411063276751225402039974239241693932340404234372954457676280692793500326419854591752564491001360283562690469220240805603606392322570410325551609523439299028338524815393826243051660156632226915891229395572183994952203819818072845088459253162868528121194015982396700695805484377712819118877860311380114980201554223670578973085482106782491803105937075207601018788868472638154660990877988272688894203079413674804759017529923175553740832393611613559240679425301178638948779254774755534376413896188925858628746022882982787311951100185047877866879656963573774422949087097164365351489189122795554242123754738388229615328414922427476912127",        "0": "352621172925978195480073680725807132629564597668889211230665651517502444054243213540279048744050455289426825079813032776308065297552711904468453648749271780640249912491845359675976316020293998330465484699020384466785674190599264320267700379588686379494801165217682655181818291189049405851904663448908727218479988764085075367836218534576927315260265691933521285460432648351363999315704399558285308391235921678766886226275868167919079946672255582306646176124199166833918703685382645720697029947912449003131290196633735538449071766640379949530372432838556849424926235975999957783676665477679548566418038861049514959736496627496059517170657851760533827193227746284378295162174392844981580868851078329854623756507809826178",        "2": "61092929925188745530080733966102727190041084120964636061248150349050192388517225890805940640137321739855048528384049792199279868648624210893782904763539784550037259048873473741608485323509606186980452167517701608856219838115624646691663593059002524018632710598051359360333118802125086068512393715315980390271335921421006776471040124179756244715327635857272351729575924911533724527660196894529808080656196961216462987560718876058870332135445670031805339845691267819569074167882147776343630589864552001626625058710940263009739015362441896240526875789746436157774766064430112606490007368439052893681577750424860816550360977562174606452481144839569419513000608338395631544404358560413773493423997436051324857997891910761"      },      "mj": "15823189903482204058645623329002082539514070199594089922519743310988189976758910839298370429239645164693109247895271709264338817301199523307016442196193833763435567950525106987991",
      "alpha":"123333",           "t": {             "1": "123",             "2": "123",             "0": "123",             "3": "123",             "DELTA":"123"           },           "predicate": {             "attr_name": "age",             "p_type": "GE",             "value": 18           }         }       ]     },     "non_revoc_proof": null   } ], "aggregated_proof": {
      "c_hash": "123",
      "c_list": [
        [187,126,130,124,185,86,231,83,78,10,151,43,  55,  99,  31,  214,  249,  161,  125,  51,  101,  191,
        60,142,  137,  184,  54,  201,  21,  35,  216,  0,  113,  19,  42,  216,  19,  76,  33,  102,  44,  248,  119,  237,  120, 182, 250, 149, 164, 210, 50, 105,
41,235,
158,
226,
39, 186, 189, 128, 58, 3, 106, 69, 244, 177, 17,
          146,
          230,
          150,
          213,
          144,
          33,
          129,
          136,
          46,
          100,
          113,
          86,
          7,
          216,
          203,
          56,
          217,
          137,
          131,
          125,
          33,
          151,
          89,
          90,
          77,
          136,
          226,
          57,
          35,
          211,
          71,
          183,
          73,
          242,
          198,
          216,
          13,
          186,
          68,
          19,
          254,
          92,
          188,
          121,
          113,
          0,
          221,
          216,
          253,
          218,
          70,
          216,
          241,
          6,
          69,
          10,
          143,
          174,
          109,
          84,
          46,
          55,
          126,
          21,
          157,
          127,
          214,
          207,
          80,
          55,
          26,
          98,
          66,
          26,
          56,
          204,
          194,
          142,
          213,
          252,
          102,
          199,
          84,
          7,
          136,
          1,
          161,
          59,
          54,
          114,
          248,
          216,
          143,
          76,
          58,
          154,
          2,
          217,
          71,
          193,
          157,
          199,
          242,
          245,
          31,
          163,
          218,
          31,
          183,
          233,
          180,
          138,
          124,
          204,
          215,
          166,
          142,
          164,
          199,
          60,
          108,
          230,
          100,
          31,
          129,
          183,
          58,
          37,
          133,
          226,
          75,
          101,
          201,
          66,
          2,
          115,
          176,
          99,
          214,
          53,
          230,
          70,
          115,
          246,
          186,
          246,
          113,
          137,
          131,
          243,
          207,
          192,
          241,
          64,
          92,
          230,
          101,
          92,
          108,
          7,
          238,
          40,
          74,
          53,
          214,
          39,
          108,
          9,
          136,
          167,
          210,
          93,
          180,
          56,
          87,
          183,
          148,
          99,
          3,
          211,
          164,
          84,
          100,
          40,
          191,
          183,
          247,
          60,
          232
        ],
        [
          2,
          140,
          36,
          47,
          200,
          228,
          14,
          0,
          15,
          128,
          176,
          42,
          87,
          249,
          33,
          111,
          24,
          62,
          253,
          120,
          100,
          118,
          148,
          237,
          99,
          83,
          244,
          151,
          79,
          124,
          106,
          69,
          152,
          221,
          179,
          107,
          36,
          244,
          45,
          112,
          104,
          6,
          33,
          33,
          168,
          22,
          230,
          106,
          149,
          132,
          99,
          83,
          59,
          178,
          72,
          63,
          119,
          159,
          94,
          9,
          77,
          91,
          92,
          74,
          138,
          125,
          32,
          30,
          123,
          173,
          74,
          78,
          7,
          83,
          149,
          246,
          191,
          217,
          66,
          83,
          141,
          225,
          186,
          120,
          125,
          155,
          47,
          111,
          185,
          218,
          168,
          77,
          98,
          235,
          169,
          146,
          242,
          46,
          218,
          62,
          56,
          179,
          6,
          27,
          199,
          246,
          89,
          193,
          246,
          200,
          187,
          183,
          111,
          152,
          55,
          193,
          33,
          105,
          214,
          249,
          151,
          233,
          8,
          42,
          84,
          112,
          141,
          156,
          130,
          209,
          237,
          139,
          246,
          177,
          22,
          91,
          86,
          12,
          5,
          17,
          234,
          238,
          206,
          222,
          15,
          32,
          38,
          12,
          99,
          209,
          238,
          240,
          33,
          114,
          139,
          88,
          245,
          169,
          51,
          194,
          75,
          46,
          97,
          59,
          42,
          154,
          209,
          219,
          36,
          218,
          156,
          141,
          246,
          208,
          28,
          94,
          255,
          32,
          118,
          202,
          222,
          220,
          152,
          28,
          55,
          172,
          144,
          108,
          1,
          108,
          97,
          164,
          139,
          218,
          63,
          184,
          77,
          43,
          73,
          129,
          18,
          75,
          100,
          205,
          61,
          33,
          218,
          52,
          155,
          15,
          4,
          206,
          14,
          234,
          163,
          241,
          194,
          124,
          143,
          166,
          51,
          0,
          14,
          151,
          97,
          117,
          209,
          182,
          59,
          1,
          143,
          98,
          142,
          72,
          232,
          55,
          12,
          144,
          70,
          162,
          119,
          23,
          88,
          39,
          42,
          198,
          156,
          202,
          138,
          219,
          169,
          219,
          10,
          247,
          77,
          224,
          218
        ],
        [
          2,
          5,
          56,
          83,
          39,
          130,
          209,
          210,
          244,
          26,
          226,
          151,
          49,
          54,
          177,
          14,
          22,
          18,
          184,
          103,
          255,
          71,
          21,
          250,
          210,
          241,
          244,
          238,
          89,
          54,
          240,
          154,
          49,
          120,
          252,
          47,
          221,
          71,
          162,
          143,
          183,
          25,
          235,
          129,
          35,
          165,
          158,
          114,
          204,
          11,
          53,
          216,
          79,
          193,
          247,
          58,
          211,
          67,
          4,
          166,
          55,
          152,
          203,
          13,
          102,
          79,
          111,
          64,
          171,
          38,
          100,
          69,
          101,
          18,
          51,
          0,
          136,
          76,
          1,
          248,
          24,
          43,
          67,
          10,
          175,
          184,
          249,
          190,
          176,
          167,
          138,
          84,
          104,
          67,
          163,
          167,
          5,
          59,
          79,
          73,
          236,
          99,
          113,
          143,
          160,
          144,
          39,
          168,
          100,
          0,
          16,
          194,
          59,
          49,
          184,
          158,
          206,
          216,
          23,
          117,
          61,
          255,
          8,
          87,
          174,
          138,
          22,
          186,
          149,
          133,
          178,
          245,
          160,
          89,
          201,
          195,
          82,
          49,
          0,
          231,
          148,
          71,
          115,
          146,
          32,
          137,
          220,
          237,
          126,
          24,
          100,
          220,
          8,
          75,
          235,
          187,
          145,
          221,
          94,
          127,
          11,
          169,
          56,
          24,
          92,
          79,
          65,
          27,
          92,
          242,
          215,
          227,
          204,
          9,
          65,
          62,
          220,
          129,
          129,
          132,
          71,
          220,
          84,
          250,
          233,
          21,
          6,
          86,
          153,
          99,
          13,
          80,
          203,
          113,
          47,
          39,
          6,
          63,
          93,
          155,
          205,
          80,
          240,
          158,
          176,
          184,
          186,
          74,
          13,
          61,
          137,
          74,
          84,
          178,
          178,
          109,
          151,
          215,
          255,
          73,
          32,
          217,
          61,
          190,
          85,
          209,
          15,
          45,
          141,
          220,
          249,
          210,
          98,
          112,
          252,
          175,
          238,
          166,
          166,
          50,
          80,
          141,
          172,
          72,
          179,
          97,
          15,
          60,
          54,
          103,
          196,
          236,
          166,
          33,
          171,
          76,
          127
        ],
        [
          1,
          51,
          52,
          251,
          57,
          1,
          243,
          62,
          157,
          53,
          37,
          119,
          136,
          22,
          166,
          66,
          56,
          216,
          204,
          184,
          55,
          89,
          211,
          129,
          115,
          192,
          132,
          53,
          49,
          72,
          128,
          70,
          152,
          75,
          201,
          56,
          234,
          88,
          195,
          64,
          59,
          69,
          251,
          49,
          221,
          240,
          145,
          123,
          60,
          183,
          226,
          140,
          74,
          235,
          91,
          179,
          180,
          204,
          161,
          57,
          217,
          29,
          125,
          63,
          19,
          217,
          151,
          123,
          222,
          156,
          132,
          214,
          14,
          176,
          201,
          171,
          137,
          172,
          168,
          198,
          91,
          94,
          218,
          84,
          255,
          36,
          42,
          125,
          114,
          212,
          94,
          236,
          181,
          185,
          1,
          171,
          167,
          36,
          58,
          63,
          123,
          47,
          169,
          44,
          236,
          218,
          47,
          79,
          126,
          119,
          71,
          205,
          244,
          199,
          176,
          211,
          213,
          191,
          50,
          60,
          169,
          112,
          27,
          174,
          142,
          182,
          228,
          253,
          74,
          85,
          172,
          94,
          134,
          116,
          218,
          8,
          126,
          206,
          133,
          54,
          132,
          78,
          159,
          113,
          72,
          123,
          105,
          38,
          55,
          40,
          230,
          132,
          35,
          221,
          247,
          89,
          191,
          74,
          131,
          184,
          204,
          30,
          145,
          10,
          184,
          177,
          73,
          32,
          213,
          107,
          200,
          53,
          134,
          204,
          178,
          202,
          166,
          165,
          72,
          24,
          132,
          21,
          43,
          0,
          252,
          180,
          110,
          28,
          59,
          238,
          97,
          168,
          197,
          18,
          15,
          216,
          48,
          182,
          249,
          163,
          215,
          108,
          149,
          153,
          89,
          38,
          118,
          182,
          116,
          227,
          176,
          102,
          204,
          33,
          81,
          94,
          72,
          139,
          222,
          213,
          122,
          6,
          66,
          100,
          121,
          202,
          57,
          170,
          134,
          60,
          246,
          199,
          153,
          213,
          196,
          16,
          155,
          228,
          17,
          217,
          148,
          124,
          166,
          182,
          86,
          248,
          28,
          134,
          220,
          237,
          146,
          35,
          147,
          202,
          74,
          58,
          56
        ],
        [
          3,
          90,
          186,
          195,
          39,
          169,
          36,
          136,
          189,
          51,
          124,
          143,
          43,
          112,
          189,
          67,
          161,
          197,
          73,
          21,
          228,
          161,
          0,
          37,
          56,
          122,
          117,
          30,
          54,
          24,
          232,
          64,
          121,
          116,
          96,
          236,
          149,
          145,
          13,
          112,
          67,
          76,
          210,
          131,
          43,
          64,
          34,
          70,
          69,
          154,
          104,
          182,
          65,
          180,
          75,
          228,
          76,
          239,
          190,
          214,
          182,
          68,
          149,
          229,
          23,
          73,
          87,
          194,
          220,
          168,
          88,
          106,
          249,
          18,
          171,
          137,
          34,
          78,
          22,
          160,
          148,
          181,
          113,
          160,
          186,
          68,
          4,
          193,
          68,
          121,
          203,
          137,
          229,
          25,
          14,
          84,
          149,
          217,
          156,
          92,
          47,
          231,
          143,
          255,
          87,
          83,
          241,
          210,
          207,
          148,
          33,
          12,
          192,
          206,
          247,
          155,
          250,
          73,
          134,
          84,
          237,
          91,
          77,
          101,
          240,
          179,
          33,
          118,
          73,
          152,
          47,
          66,
          63,
          173,
          225,
          80,
          200,
          148,
          197,
          83,
          68,
          165,
          107,
          105,
          8,
          205,
          183,
          82,
          9,
          15,
          109,
          235,
          241,
          236,
          1,
          42,
          133,
          147,
          42,
          84,
          32,
          65,
          213,
          108,
          67,
          71,
          111,
          213,
          207,
          77,
          49,
          62,
          172,
          192,
          110,
          220,
          171,
          56,
          28,
          127,
          65,
          126,
          59,
          188,
          175,
          11,
          114,
          255,
          104,
          115,
          0,
          147,
          136,
          248,
          140,
          176,
          110,
          82,
          162,
          31,
          203,
          29,
          154,
          59,
          183,
          34,
          219,
          116,
          188,
          245,
          237,
          67,
          146,
          23,
          105,
          27,
          121,
          31,
          8,
          160,
          176,
          51,
          18,
          72,
          180,
          197,
          5,
          248,
          49,
          239,
          18,
          220,
          165,
          152,
          255,
          64,
          255,
          62,
          234,
          231,
          236,
          143,
          100,
          79,
          47,
          84,
          139,
          140,
          61,
          253,
          3,
          186,
          168,
          80,
          214,
          131,
          10
        ],
        [
          1,
          218,
          235,
          143,
          135,
          53,
          105,
          177,
          227,
          253,
          173,
          143,
          40,
          85,
          21,
          223,
          98,
          36,
          238,
          39,
          45,
          23,
          80,
          58,
          129,
          47,
          168,
          58,
          198,
          121,
          114,
          182,
          98,
          19,
          113,
          8,
          116,
          69,
          145,
          109,
          57,
          13,
          246,
          125,
          192,
          66,
          8,
          33,
          138,
          236,
          90,
          210,
          184,
          28,
          138,
          171,
          8,
          191,
          177,
          185,
          39,
          4,
          220,
          191,
          102,
          153,
          198,
          67,
          166,
          72,
          166,
          232,
          239,
          82,
          66,
          157,
          30,
          90,
          27,
          187,
          160,
          95,
          4,
          231,
          49,
          63,
          88,
          66,
          83,
          123,
          148,
          152,
          26,
          33,
          151,
          116,
          26,
          90,
          73,
          122,
          5,
          158,
          161,
          47,
          101,
          26,
          207,
          19,
          174,
          154,
          246,
          177,
          189,
          182,
          156,
          177,
          174,
          118,
          187,
          54,
          172,
          60,
          189,
          239,
          61,
          95,
          209,
          92,
          142,
          19,
          121,
          21,
          9,
          168,
          187,
          170,
          229,
          64,
          32,
          58,
          209,
          101,
          96,
          208,
          73,
          128,
          48,
          183,
          156,
          190,
          152,
          237,
          125,
          148,
          166,
          30,
          144,
          251,
          5,
          44,
          154,
          50,
          57,
          196,
          182,
          14,
          35,
          111,
          238,
          191,
          208,
          169,
          56,
          21,
          40,
          187,
          106,
          150,
          239,
          202,
          253,
          24,
          161,
          192,
          30,
          179,
          97,
          132,
          158,
          182,
          69,
          90,
          122,
          243,
          61,
          232,
          31,
          125,
          149,
          159,
          44,
          34,
          227,
          59,
          91,
          217,
          243,
          241,
          20,
          174,
          48,
          95,
          151,
          230,
          174,
          91,
          250,
          189,
          118,
          172,
          217,
          109,
          29,
          56,
          158,
          77,
          157,
          105,
          105,
          180,
          0,
          172,
          33,
          144,
          212,
          64,
          3,
          120,
          172,
          52,
          144,
          59,
          176,
          248,
          81,
          22,
          153,
          27,
          176,
          177,
          96,
          115,
          135,
          21,
          57,
          216,
          144
        ]
      ]
    }
  },
  "requested_proof": {
    "revealed_attrs": {
      "sex": {
        "sub_proof_index": 0,
        "raw": "M",
        "encoded": "4046863355387123130204462347062573430393022542838002397178812848050724434929"
      }
    },
    "self_attested_attrs": {},
    "unrevealed_attrs": {},
    "predicates": {
      "age": {
        "sub_proof_index": 0
      }
    }
  },
  "identifiers": [
    {
      "schema_id": "mock:uri2",
      "cred_def_id": "mock:uri3",
      "rev_reg_id": null,
      "timestamp": null
    }
  ]
}
      """
    )
    println("44444444444444")
    val x1: anoncreds_wrapper.PresentationRequest = presentationRequest
    println("55555555555555")
    // val x2: java.util.Map[String, Schema]
    // val x3: java.util.Map[String, CredentialDefinition]
    println("66666666666666")
    println("77777777777777")
    anoncreds_wrapper
      .Verifier()
      .verifyPresentation(
        presentation, // Presentation presentation,
        presentationRequest, // PresentationRequest presentation_request,
        schemas.view
          .mapValues(i => i: anoncreds_wrapper.Schema)
          .toMap
          .asJava, // record<SchemaId, Schema> schemas,
        credentialDefinitions.view.mapValues(i => i: anoncreds_wrapper.CredentialDefinition).toMap.asJava
        // record<CredentialDefinitionId, CredentialDefinition> credential_definitions
      )
  }
}
