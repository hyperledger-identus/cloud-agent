components:
  schemas:
    DIDOperationResponse:
      type: object
      required:
        - scheduledOperation
      properties:
        scheduledOperation:
          $ref: "#/components/schemas/DidOperationSubmission"

    CreateManagedDidRequest:
      type: object
      required:
        - documentTemplate
      properties:
        documentTemplate:
          type: object
          required:
            - storage
            - publicKeys
            - services
          properties:
            publicKeys:
              type: array
              items:
                $ref: "#/components/schemas/ManagedDIDKeyTemplate"
            services:
              type: array
              items:
                $ref: "../tapir-generated.yaml#/components/schemas/Service"

    CreateManagedDIDResponse:
      type: object
      required:
        - longFormDid
      properties:
        longFormDid:
          type: string
          description: A long-form DID for the created DID
          example: did:prism:4a5b5cf0a513e83b598bbea25cd6196746747f361a73ef77068268bc9bd732ff:Cr4BCrsBElsKBmF1dGgtMRAEQk8KCXNlY3AyNTZrMRIg0opTuxu-zt6aRbT1tPniG4eu4CYsQPM3rrLzvzNiNgwaIIFTnyT2N4U7qCQ78qtWC3-p0el6Hvv8qxG5uuEw-WgMElwKB21hc3RlcjAQAUJPCglzZWNwMjU2azESIKhBU0eCOO6Vinz_8vhtFSAhYYqrkEXC8PHGxkuIUev8GiAydFHLXb7c22A1Uj_PR21NZp6BCDQqNq2xd244txRgsQ

    UpdateManagedDIDRequest:
      type: object
      required:
        - actions
      properties:
        actions:
          type: array
          description: |
            A list of actions to perform on DID document.
            The field `addKey`, `removeKey`, `addService`, `removeService`, `updateService` must corresponds to
            the `actionType` specified. For example, `addKey` must be present when `actionType` is `ADD_KEY`.
          items:
            type: object
            description: Detail of DID update action. Only property matching actionType can be present.
            required:
              - actionType
            properties:
              actionType:
                type: string
                enum:
                  - ADD_KEY
                  - REMOVE_KEY
                  - ADD_SERVICE
                  - REMOVE_SERVICE
                  - UPDATE_SERVICE
                example: ADD_KEY
              addKey:
                $ref: "#/components/schemas/ManagedDIDKeyTemplate"
              removeKey:
                type: object
                required:
                  - id
                properties:
                  id:
                    type: string
                    description: ID of key to remove from DID document
                    example: key-1
              addService:
                $ref: "../tapir-generated.yaml#/components/schemas/Service"
              removeService:
                type: object
                required:
                  - id
                properties:
                  id:
                    type: string
                    description: ID of service to remove from DID document
                    example: service-1
              updateService:
                type: object
                description: A patch to existing Service. 'type' and 'serviceEndpoint' can't both be empty.
                required:
                  - id
                properties:
                  id:
                    type: string
                    description: ID of existing service to update in the DID document
                    example: service-1
                  type:
                    type: string
                    enum:
                      - LinkedDomains
                    example: LinkedDomains
                  serviceEndpoint:
                    type: array
                    items:
                      type: string
                      example: "https://bar.example.com/"

    ManagedDIDPage:
      allOf:
        - $ref: "../shared/schemas.yaml#/components/schemas/Pagination"
        - type: object
          required: [contents]
          properties:
            contents:
              type: array
              items:
                $ref: "#/components/schemas/ManagedDID"

    ManagedDID:
      type: object
      required:
        - did
        - status
      properties:
        did:
          type: string
          example: did:prism:4a5b5cf0a513e83b598bbea25cd6196746747f361a73ef77068268bc9bd732ff
        longFormDid:
          type: string
          description: A long-form DID. Mandatory when status is not PUBLISHED and optional when status is PUBLISHED
          example: did:prism:4a5b5cf0a513e83b598bbea25cd6196746747f361a73ef77068268bc9bd732ff:Cr4BCrsBElsKBmF1dGgtMRAEQk8KCXNlY3AyNTZrMRIg0opTuxu-zt6aRbT1tPniG4eu4CYsQPM3rrLzvzNiNgwaIIFTnyT2N4U7qCQ78qtWC3-p0el6Hvv8qxG5uuEw-WgMElwKB21hc3RlcjAQAUJPCglzZWNwMjU2azESIKhBU0eCOO6Vinz_8vhtFSAhYYqrkEXC8PHGxkuIUev8GiAydFHLXb7c22A1Uj_PR21NZp6BCDQqNq2xd244txRgsQ
        status:
          type: string
          description: |
            A status indicating a publication state of a DID in the wallet (e.g. PUBLICATION_PENDING, PUBLISHED).
            Does not represent DID a full lifecyle (e.g. deactivated, recovered, updated).
          enum:
            - CREATED
            - PUBLICATION_PENDING
            - PUBLISHED

    ManagedDIDKeyTemplate:
      type: object
      description: key-pair template to add to DID document.
      required:
        - id
        - purpose
      properties:
        id:
          type: string
          description: Identifier of a verification material in the DID Document
          example: key-1
        purpose:
          type: string
          enum:
            [
              "authentication",
              "assertionMethod",
              "keyAgreement",
              "capabilityInvocation",
              "capabilityDelegation",
            ]
          example: "authentication"

    # ----------------------------------
    # ASYNC OPERATIONS
    # ----------------------------------
    DidOperationSubmission:
      type: object
      required:
        - id
        - didRef
      properties:
        id:
          type: string
          example: 98e6a4db10e58fcc011dd8def5ce99fd8b52af39e61e5fb436dc28259139818b
        didRef:
          type: string
          example: did:prism:4a5b5cf0a513e83b598bbea25cd6196746747f361a73ef77068268bc9bd732ff
